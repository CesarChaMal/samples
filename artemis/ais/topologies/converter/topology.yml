tosca_definitions_version: alien_dsl_2_0_0

metadata:
  template_name: AisConverter
  template_version: 0.1.0-SNAPSHOT
  template_author: admin

description: ""

imports:
  - tosca-normative-types:1.0.0-ALIEN20
  - artemis.ais.converter:2.1.0-SNAPSHOT
  - artemis.hadoop.pub:2.1.0-SNAPSHOT
  - docker-types:2.2.0-SNAPSHOT

topology_template:
  node_templates:
    ContainerDeploymentUnit:
      metadata:
        a4c_edit_x: 152
        a4c_edit_y: "-88"
      type: org.alien4cloud.extended.container.types.ContainerDeploymentUnit
      capabilities:
        scalable:
          properties:
            min_instances: 1
            max_instances: 1
            default_instances: 1
    ContainerRuntime:
      type: org.alien4cloud.extended.container.types.ContainerRuntime
      requirements:
        - hostedOnContainerDeploymentUnitHost:
            type_requirement: host
            node: ContainerDeploymentUnit
            capability: tosca.capabilities.Container.Docker
            relationship: tosca.relationships.HostedOn
    RawConverter:
      type: artemis.ais.containers.nodes.RawConverter
      properties:
        docker_run_cmd: "/opt/bigdata/bin/start.sh"
        config_settings: 
          - input_prefix: "CFG_"
            mount_path: "/config"
            config_path: configFiles
        raw0_home_dir: "/aisliv/data/ais/raw0"
        raw0_incoming_subdir: incoming
        raw0_inprogress_subdir: inprogress
        raw0_converted_subdir: converted
        raw0_failed_subdir: failed
        raw1_dir: "/aisliv/data/ais/raw1"
        cpu_share: 1.0
        mem_share: "1 GB"
      requirements:
        - RawConverter_hdfs_input:
            type_requirement: hdfs_input
            node: Input
            capability: artemis.hadoop.pub.capabilities.HDFSEndpoint
            relationship: tosca.relationships.ConnectsTo
        - RawConverter_hdfs_output:
            type_requirement: hdfs_output
            node: Output
            capability: artemis.hadoop.pub.capabilities.HDFSEndpoint
            relationship: tosca.relationships.ConnectsTo
        - hostedOnContainerRuntimeContainerRuntimeHost:
            type_requirement: host
            node: ContainerRuntime
            capability: org.alien4cloud.extended.container.capabilities.ApplicationHost
            relationship: org.alien4cloud.extended.container.relationships.HostedOnContainerRuntime
      capabilities:
        scalable:
          properties:
            min_instances: 1
            max_instances: 1
            default_instances: 1
    Input:
      metadata:
        a4c_edit_x: 515
        a4c_edit_y: "-201"
      type: artemis.hadoop.pub.nodes.HDFSService
      capabilities:
        hdfs_endpoint:
          properties:
            port: 9000
            protocol: hdfs
            secure: false
            network_name: PRIVATE
            initiator: source
        http_endpoint:
          properties:
            port: 50070
            protocol: http
            secure: false
            network_name: PRIVATE
            initiator: source
    Output:
      metadata:
        a4c_edit_x: 515
        a4c_edit_y: "-105"
      type: artemis.hadoop.pub.nodes.HDFSService
      capabilities:
        hdfs_endpoint:
          properties:
            port: 9000
            protocol: hdfs
            secure: false
            network_name: PRIVATE
            initiator: source
        http_endpoint:
          properties:
            port: 50070
            protocol: http
            secure: false
            network_name: PRIVATE
            initiator: source
